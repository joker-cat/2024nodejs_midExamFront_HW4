import{_ as l,a as d,c,d as e,w as p,i as h,s as m,o as u,p as f,j as g}from"./index-BWhio717.js";const _={data(){return{image:"",content:"",file:""}},computed:{...d(m,["getUserState"])},methods:{handleFileUpload(){this.file=this.$refs.file.files[0];const t=new FileReader;t.addEventListener("load",this.imageLoaded),t.readAsDataURL(this.file)},imageLoaded(t){this.image=t.target.result},async updateImage(){const t=new FormData;return t.append("image",this.file),t.append("album","GyuOpeD"),await this.$http.post("https://api.imgur.com/3/image",t,{headers:{Authorization:"Bearer e0d3586d25b4a34a016d23f70ae8012a752a402b"}})},async pushArticle(){if(this.image.trim()===""||this.content.trim()===""){alert("請填寫完整內文及圖片");return}try{const r={image:(await this.updateImage()).data.data.link,content:this.content,user:this.getUserState._id};await this.$http.post("https://two024nodejs-midexamback-hw4.onrender.com/post",r),this.image="",this.content="",this.file="",alert("新增成功"),this.$router.push("/")}catch(t){console.error(t),alert("新增失敗")}}}},n=t=>(f("data-v-1a73214d"),t=t(),g(),t),w={class:"post-content"},x=n(()=>e("div",{class:"title"},[e("h2",{class:"text-center"},"張貼動態"),e("div",{class:"empty-bg"})],-1)),b={class:"create"},I=n(()=>e("p",{class:"create-depiction"},"貼文內容",-1)),v=n(()=>e("label",{for:"fileInput",class:"input-btn"},"選擇圖片",-1)),U=["src"];function k(t,a,r,y,o,i){return u(),c("div",w,[x,e("div",b,[I,p(e("textarea",{name:"textarea-font",id:"textarea",cols:"30",rows:"10","onUpdate:modelValue":a[0]||(a[0]=s=>o.content=s)},null,512),[[h,o.content]]),e("input",{type:"file",name:"file",class:"d-none",id:"fileInput",ref:"file",onChange:a[1]||(a[1]=(...s)=>i.handleFileUpload&&i.handleFileUpload(...s))},null,544),v,e("img",{class:"show-image w-100",src:o.image,alt:"要上傳的圖片"},null,8,U),e("button",{type:"button",class:"create-post d-block text-center mx-auto",onClick:a[2]||(a[2]=(...s)=>i.pushArticle&&i.pushArticle(...s))}," 送出貼文 ")])])}const A=l(_,[["render",k],["__scopeId","data-v-1a73214d"]]);export{A as default};
